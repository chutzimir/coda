#		 Master Coda Makeconf file
# sets:
#	VPATH, DIRS, FLAGS, LIBRARIES, <>_RPC2
# includes:
#	Makefile.setup,	configs/Makeconf.$(SYS)

# 11/18/96 Created, Josh Raiff
# 11/19/96 Modified, Peter Braam


#########################################################
#  Coda 4.5.0 build environment
#  little here should need editing
#########################################################

include $(TOPOBJ)/Makeconf.setup

LIBEXECDIR:=$(libexecdir)
BINDIR:=$(bindir)
SBINDIR:=$(sbindir)
INITDIR:=$(prefix)/$(initsuffix)
MANDIR:=$(mandir)

include $(TOPDIR)/configs/Makeconf.$(SYS)

##############################
# VPATH & INCLUDE DIRECTORY
##############################

# edit VPATH appropiately

ifneq ($(SECSRC),)
VPATHTAIL := $(subst $(TOPDIR),,$(VPATH))
NEWVPATH := $(SECSRC)$(VPATHTAIL):$(VPATH)
VPATH := $(NEWVPATH)
endif

INCLDIR=$(TOPOBJ)/include

ifneq ($(VPATH),)
colon=:

INCLPATH  := .:$(VPATH):$(INCLDIR)
INCLFLAGS :=  -I$(TOPOBJ) -I$(subst $(colon), -I,$(INCLPATH))
else
INCLFLAGS :=  -I$(TOPOBJ) -I. -I$(INCLDIR)
INCLPATH  := .:$(INCLDIR)
endif

vpath %.h $(INCLPATH)
vpath %.rpc2 $(INCLPATH)

##############################
# Location of objects
##############################

RP2GEN := rp2gen

##############################
# Machine independent FLAGS
##############################

DEPFLAG   := -MD
CFLAGS	  := $(CFLAGS)   $(DEPFLAG) $(MACHINE_FLAGS) $(MYFLAGS) $(INCLFLAGS)
CXXFLAGS  := $(CXXFLAGS) $(DEPFLAG) $(MACHINE_FLAGS) $(MYFLAGS) $(INCLFLAGS)

RP2FLAGS  = -e  -I . -I $(srcdir) 

LIBS	  := $(LIBS) $(LIBCOMPAT) $(LIBFIXUP) $(LIBUCB)


# uncomment some of the next lines if you have kerberos
# KERBEROS=yes
# KERBEROS4=yes
# KERBEROS5=yes

##############################
# Library definitions
##############################

# -- INODEFS --
# platform dependent: choice from user level and kernel level version
# defined in configs/Makeconf.$(SYS)
# LIBINODEFS = $(TOPOBJ)/$(INODEFSDIR)/$(INODEFSNAME)

# -- CS --
LIBBASE =$(TOPOBJ)/lib-src/base/libbase.a

# -- LWP --
LIBLWP = -llwp

# -- READLINE --
LIBREADLINE = -lreadline

# -- RVM --
LIBRVM := -lrvm
LIBRDS := -lrds
LIBSEG := -lseg
# with threads
LIBRVMLWP := -lrvmlwp
LIBRDSLWP := -lrdslwp

# -- RPC2 --
LIBRPC2 := -lrpc2
LIBSE   := -lse
LIBFAIL := -lfail

# -- CODA --
LIBKERNDEP =../kerndep/libkerndep.a   # --- (pioctl, setpag)
LIBAUTH2 =../auth2/libauth2.a
LIBAL = ../al/libal.a
LIBVOL = ../vol/libvol.a
LIBVICEDEP= ../vicedep/libvicedep.a
LIBVOLUTIL =../volutil/libvolutil.a
LIBVOLSERV =../volutil/libvolserv.a
LIBVV = ../vv/libvv.a
LIBREPAIR =../librepair/librepair.a
LIBUTIL =../util/libutil.a
LIBPORTMAP =../portmapper/libportmap.a
LIBRES =../resolution/libres.a
LIBDIRLIB= ../dir/libdir.a
LIBNDIRLIB= ../ndir/libcodadir.a
LIBDIRLIB= ../dir/libcodadir.a
LIBVICEERROR  = ../vice/libviceerror.a
LIBDS = ../ds/libds.a
LIBPARTITION = ../partition/libpartition.a


##############################
# RPC2 interface definitions in module vicedep
##############################
CALLBACK_RPC2 = ../vicedep/callback.rpc2
MOND_RPC2 = ../vicedep/mond.rpc2
VCRCOMMON_RPC2 = ../vicedep/vcrcommon.rpc2
VICE_RPC2 = ../vicedep/vice.rpc2
VOLDUMP_RPC2 = ../vicedep/voldump.rpc2
VOLUTIL_RPC2 = ../vicedep/volutil.rpc2
RES_RPC2 = ../vicedep/res.rpc2
ADMON_RPC2 = ../vicedep/admon.rpc2
ADSRV_RPC2 = ../vicedep/adsrv.rpc2

