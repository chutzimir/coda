# 
# BLURB gpl
# 
#                            Coda File System
#                               Release 5
# 
#           Copyright (c) 1987-1999 Carnegie Mellon University
#                   Additional copyrights listed below
# 
# This  code  is  distributed "AS IS" without warranty of any kind under
# the terms of the GNU General Public Licence Version 2, as shown in the
# file  LICENSE.  The  technical and financial  contributors to Coda are
# listed in the file CREDITS.
# 
#                         Additional copyrights
#                            none currently
# 
#*/

TOPDIR = @top_srcdir@

srcdir = @srcdir@
VPATH  = @srcdir@
TOPOBJ = @TOPOBJ@

include $(TOPDIR)/Makeconf
CXXFLAGS += -Wall
LIBRARIES  = libreslib.a
HEADERS	   =  rescomm.h logalloc.h pdlist.h remotelog.h resforce.h \
	      reslog.h resutil.h lockqueue.h timing.h

RESC_LIBS  = ${LIBKERNDEP} ${LIBRPC2} ${LIBOLDLWP}

RESLIBOBJS = logalloc.o pdlist.o remotelog.o resclient.o lockqueue.o\
             rescoord.o  resforce.o reslock.o reslog.o \
             resutil.o rescomm.o timing.o weres.o 

libreslib.a:	${RESLIBOBJS}

# Test programs
resc: resc.o  vice.client.o callback.server.o $(RESC_LIBS) ${LIBFIXUP}
	$(CXX) $(LIBFLAGS) resc.o vice.client.o callback.server.o $(RESC_LIBS) ${LIBFIXUP} -o resc

testpdlist: testpdlist.o pdlist.o logalloc.o $(LIBUTIL) ${LIBFIXUP}
	$(CXX) $(LIBFLAGS) testpdlist.o pdlist.o logalloc.o ${LIBUTIL} ${LIBFIXUP} -o testpdlist

test: test.o logalloc.o ${LIBUTIL} ${LIBFIXUP}
	$(CXX) $(LIBFLAGS) test.o logalloc.o ${LIBUTIL} ${LIBFIXUP} -o test

timetest: timetest.o timing.o ${LIBUTIL} ${LIBFIXUP}
	$(CXX) $(LIBFLAGS) timetest.o timing.o ${LIBUTIL} ${LIBFIXUP} -o timetest


${RESLIBOBJS}: ${HEADERS}

pdlist.o: logalloc.h 

resc.o: vice.h callback.h

reslog.o: logalloc.h

include $(TOPDIR)/configs/Makerules
