# BLURB gpl
# 
#                            Coda File System
#                               Release 5
# 
#           Copyright (c) 1987-1999 Carnegie Mellon University
#                   Additional copyrights listed below
# 
# This  code  is  distributed "AS IS" without warranty of any kind under
# the terms of the GNU General Public Licence Version 2, as shown in the
# file  LICENSE.  The  technical and financial  contributors to Coda are
# listed in the file CREDITS.
# 
#                         Additional copyrights
#                            none currently
# 
#*/

TOPDIR = @top_srcdir@

srcdir = @srcdir@
VPATH  = @srcdir@
TOPOBJ = @TOPOBJ@

include $(TOPDIR)/Makeconf

EXECUTABLES = norton norton-reinit
SCRIPTS     = reinit
SBINS       = $(EXECUTABLES) $(SCRIPTS)

ifeq ($(SYS),sol2)
LIBFIXUP += -R/usr/ucblib -L/usr/ucblib -lucb
endif

NLIBS =	$(LIBIBERTY) \
	$(LIBAUTH2)	\
	$(LIBRES)	\
	$(LIBAL)	\
	$(LIBREPAIR)	\
	$(LIBVOL)	\
	$(LIBVOLUTIL)	\
	$(LIBVV)	\
	${LIBPARTITION}\
	$(LIBSYSENT)	\
	$(LIBDIRLIB)	\
	$(LIBUTIL) 	\
	$(LIBCODARDS) 	\
	$(LIBSEG) 	\
	$(LIBCODARVM) 	\
	$(LIBRPC2) 	\
	$(LIBOLDLWP)	\
	$(LIBBASE)      \
	$(LIBMACH)

STD_LIBS = $(LIBCOMPAT)	\
	$(LIBREADLINE)  \
	$(LIBTERMCAP)	\
	$(LIBFIXUP)

common_objects = norton-setup.o commands.o norton-volume.o \
		 norton-recov.o norton-vnode.o norton-dir.o norton-rds.o dummy.o

norton_objs =	norton.o ${common_objects}
reinit_objs =	norton-reinit.o ${common_objects}

include $(TOPDIR)/configs/Makerules

norton: ${norton_objs} ${NLIBS}
	$(CXX) $(LIBFLAGS) ${norton_objs} ${NLIBS} $(LIBDB) ${STD_LIBS} -lm -o norton

norton-reinit: ${reinit_objs} ${NLIBS}
	$(CXX) $(LIBFLAGS) ${reinit_objs} ${NLIBS} $(LIBDB) ${STD_LIBS} -lm -o norton-reinit
