# 
# BLURB gpl
# 
#                            Coda File System
#                               Release 5
# 
#           Copyright (c) 1987-1999 Carnegie Mellon University
#                   Additional copyrights listed below
# 
# This  code  is  distributed "AS IS" without warranty of any kind under
# the terms of the GNU General Public Licence Version 2, as shown in the
# file  LICENSE.  The  technical and financial  contributors to Coda are
# listed in the file CREDITS.
# 
#                         Additional copyrights
#                            none currently
# 
#*/

TOPDIR = @top_srcdir@

srcdir = @srcdir@
VPATH  = @srcdir@
TOPOBJ = @TOPOBJ@

include $(TOPDIR)/Makeconf

EXECUTABLES = parser
ifeq ($(SYS),cywin32)
EXECUTABLES = parser
endif
CBINS       = $(EXECUTABLES)
HEADERS     = asr.h ruletypes.h

YFLAGS += -d

LIBS=	$(LIBKERNDEP) $(LIBUTIL) $(LIBBASE)

#uncomment if you want to turn on timing of the ASR 
#PERSONAL_FLAGS= -DTIMING

OBJECTS = y.tab.o lex.yy.o ruletypes.o resolver.o wildmat.o path.o

parser: ${OBJECTS} $(LIBS)
	$(CXX) $(LIBFLAGS) ${OBJECTS} $(LIBS) $(LIBFLEX) -o parser

# Dependencies
y.tab.c: $(srcdir)/resolver.yacc
	yacc -d $<

lex.yy.c: resolver.lex

# YYuck!  I don't know how to tell yyac to deliver a .cc extension  GRRR..(pjb)
y.tab.o: y.tab.c
	$(CXX) -x c++ $(CFLAGS) -c $<


include $(TOPDIR)/configs/Makerules
