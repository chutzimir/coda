# 			Let's build coda!

# TARGETS:
#	install	recursively build and install objects
#	all	recursively build objects
#	clean	recursively descend the tree and clean .a's, .o's, binaries, ...
#	rcs	populate the tree with rcs links
#	reconfigure
#		do a ../configure again with all the same args
# Josh Raiff
# Moved up further Peter Braam

TOPDIR = @top_srcdir@
ifndef MAKDIR
MAKDIR = @top_srcdir@
endif
srcdir = @srcdir@
VPATH  = @srcdir@

SECSRC = @SECSRC@
SHOB   = @SHOB@
TOPOBJ = @TOPOBJ@

include $(MAKDIR)/Makeconf

EXECUTABLES = md

  I =  kernel-src
 II =  lib-src
III =  rvm-src
 IV =  coda-src
# V =  utils-src

SUBDIRS = $(EXTRAS) $(I) $(II) $(III) $(IV) $(V)

CC:=$(NATIVECC)

md: md.o
	$(CC) $(LIBFLAGS) -o md md.o

md.o: md.c
	$(CC) -c $<


include $(MAKDIR)/configs/Makerules

reconfigure:
	$(TOPDIR)/configure $(TAIL)

TAIL=
ifdef SHOB
TAIL  += --enable-shareobj=$(SHOB)
endif
ifdef SECSRC
TAIL  += --enable-srcdir=$(SECSRC)
endif
