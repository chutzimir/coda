#ifndef _BLURB_
#define _BLURB_
#
#
#     RVM: an Experimental Recoverable Virtual Memory Package
#			Release 1.3
#
#       Copyright (c) 1990-1994 Carnegie Mellon University
#                      All Rights Reserved.
#
# Permission  to use, copy, modify and distribute this software and
# its documentation is hereby granted (including for commercial  or
# for-profit use), provided that both the copyright notice and this
# permission  notice  appear  in  all  copies  of   the   software,
# derivative  works or modified versions, and any portions thereof,
# and that both notices appear  in  supporting  documentation,  and
# that  credit  is  given  to  Carnegie  Mellon  University  in all
# publications reporting on direct or indirect use of this code  or
# its derivatives.
#
# RVM  IS  AN  EXPERIMENTAL  SOFTWARE  PACKAGE AND IS KNOWN TO HAVE
# BUGS, SOME OF WHICH MAY  HAVE  SERIOUS  CONSEQUENCES.    CARNEGIE
# MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS" CONDITION.
# CARNEGIE MELLON DISCLAIMS ANY  LIABILITY  OF  ANY  KIND  FOR  ANY
# DAMAGES  WHATSOEVER RESULTING DIRECTLY OR INDIRECTLY FROM THE USE
# OF THIS SOFTWARE OR OF ANY DERIVATIVE WORK.
#
# Carnegie Mellon encourages (but does not require) users  of  this
# software to return any improvements or extensions that they make,
# and to grant Carnegie Mellon the  rights  to  redistribute  these
# changes  without  encumbrance.   Such improvements and extensions
# should be returned to Software.Distribution@cs.cmu.edu.
#
# rcsid = $Header$
#
#endif _BLURB_

#   	SEG Makefile : depends on csmake

TOPDIR = @top_srcdir@
srcdir = @srcdir@
VPATH = @srcdir@
TOPOBJ= @TOPOBJ@

# Need to conditionalize this
include $(TOPDIR)/Makeconf


# seg definitions
EXPHEADERS = rvm_segment.h 
PRIVHEADERS = rvm_segment_private.h
HEADERS = ${EXPHEADERS} ${PRIVHEADERS}
LIBRARIES = libseg.a

OBJECTS = rvm_segutil.o rvm_loadseg.o rvm_createseg.o

# Used to make depend
SOURCES = ${OBJECTS:.o=.c}
# by convention, Makeconf.sys must be in the same directory as
# Makeconf
DEPDEP  = ${SOURCES} ${HEADERS} ${MAKEFILE} ${MAKECONF} \
	  ${MAKECONF:Makeconf=Makeconf.sys}
DERIVED = 

LIBS    = libseg.a
BINS    = 
TARGETS = ${LIBS} ${BINS}

#make all.
all: ${TARGETS}

safe: depend all

#build SEG library
libseg.a:  $(OBJECTS)
	ar rv $@ $?
	ranlib $@

#optionally use dependencies
# -include Depend

# Make clean: requires definition of TARGETS and OBJECTS
clean:
	-rm -f ${TARGETS} ${OBJECTS}

# Make sterile: clean plus removal of DERIVED and Depend
sterile: clean
	-rm -f ${DERIVED} Depend

# Make depend: requires use of a compiler that understands -M
# depend is remade when DEPDEP changes

depend: Depend
Depend: ${DEPDEP}
	$(CC) -M $(CFLAGS) $(SOURCES) > Depend

# Make install: requires EXPHEADERS LIBS and BINS
#install: srcinstall hdrinstall libinstall

## setenv SUPPRESS_DOSRCINSTALL if you want to suppress the RCS checkin
## by dosrcinstall
#srcinstall:
#	SRCDIR=$(SRCDIR); SYS=$(SYS); \
#	export SRCDIR; export SYS;    \
#        $(DOSRCINSTALL)	

#hdrinstall: ${EXPHEADERS}
#	-chmod 0644 $(INCLDIR)/*
#	${INSTALL} $> $(INCLDIR)
#	-chmod 0444 $(INCLDIR)/*

#libinstall: ${LIBS}
#	-chmod 0644 $(LIBDIR)/*
#	${INSTALL} $> $(LIBDIR)
#	-chmod 0444 $(LIBDIR)/*

#bininstall: ${BINS}
#	-chmod 0644 $(BINDIR)/*
#	${INSTALL} $> $(BINDIR)
#	-chmod 0444 $(BINDIR)/*


# to install in lib-special and lib-include
LIBDIR := $(LIBSPECIAL)
INCLDIR := $(INCLSPECIAL)

include $(TOPDIR)/Makerules
